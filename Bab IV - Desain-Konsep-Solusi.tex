% ==========================================
% BAB IV DESAIN KONSEP SOLUSI
% ==========================================

\chapter{DESAIN KONSEP SOLUSI}
\label{chap:desain-konsep-solusi}

Bab ini memaparkan rancangan konsep solusi yang diusulkan untuk menjawab permasalahan yang telah dianalisis pada bab sebelumnya. Berdasarkan hasil analisis pemilihan solusi, pendekatan yang digunakan dalam penelitian ini adalah pengembangan sistem eksperimen terotomatisasi berbasis konfigurasi. Pembahasan dalam bab ini mencakup desain konseptual eksperimen, perancangan arsitektur perangkat lunak atau \textit{evaluation pipeline}, serta spesifikasi implementasi data dan struktur berkas. Desain ini disusun untuk memenuhi kebutuhan fungsional terkait strukturisasi \textit{user persona} dan konsistensi eksekusi lintas model.
%====== BAB IV.1 ======
\section{Desain Konseptual Eksperimen}
\label{sec:desain-konseptual}

Bagian ini menjelaskan desain konseptual eksperimen yang digunakan untuk menilai pengaruh variasi \textit{user persona} terhadap pola respons model. Perancangan ini berfokus pada pengendalian variabel masukan, keseragaman prosedur evaluasi, serta pencatatan telemetri yang lengkap agar eksperimen dapat dijalankan secara konsisten dan direplikasi oleh peneliti lain.

Eksperimen dirancang untuk menjawab dua kebutuhan utama. Pertama, kebutuhan akan metodologi yang mampu mengisolasi pengaruh persona dari faktor lain seperti variasi redaksional instruksi atau inkonsistensi proses pengujian \parencite{gupta2024biasrunsdeep}. Kedua, kebutuhan akan sistem yang mampu mengeksekusi jumlah kombinasi model, persona, dan soal yang besar tanpa intervensi manual, seraya tetap menghasilkan artefak data yang terstruktur dengan baik dan kompatibel untuk analisis lanjutan \parencite{tseng2024twotales,naous2025userlm}.

\subsection{Pendekatan Evaluasi Konvensional}
\label{subsec:existing-approach}

Pendekatan umum dalam evaluasi persona pada model percakapan dilakukan secara manual melalui antarmuka interaktif. Peneliti menyisipkan instruksi persona dalam bentuk narasi, mengajukan pertanyaan satu per satu, lalu menyalin jawaban model secara manual ke dalam lembar kerja. Walaupun sederhana, pendekatan tersebut memiliki beberapa kelemahan mendasar.

Pertama, kontrol terhadap masukan tidak stabil. Model diketahui sangat sensitif terhadap variasi kecil pada formulasi instruksi seperti panjang kalimat, pilihan diksi, atau posisi frasa tertentu \parencite{zhou2023largemodelsensitive}. Dalam praktik manual, variasi semacam ini sulit dihindari sehingga hasil evaluasi berpotensi tercampur oleh artefak redaksional.

Kedua, keluaran yang direkam biasanya terbatas pada jawaban verbal tanpa menyertakan metadata teknis seperti jumlah token, latensi, atau parameter konfigurasi. Padahal, penelitian mutakhir menunjukkan bahwa telemetri tersebut penting untuk memahami hubungan antara proses penalaran, beban komputasi, dan stabilitas keluaran \parencite{turpin2023language,bommasani2021opportunities}.

Ketiga, pendekatan manual tidak cocok untuk skala eksperimen yang besar. Ketika rentang kombinasi mencakup banyak persona, model, dan dua \textit{benchmark}, proses pencatatan menjadi tidak efisien serta rentan kesalahan.

\subsection{Model Sistem Terorkestrasi yang Diusulkan}
\label{subsec:proposed-system}

Untuk mengatasi keterbatasan tersebut, penelitian ini mengusulkan sistem eksperimen terorkestrasi berbasis \textit{evaluation pipeline}. Seluruh artefak, mulai dari persona, soal, hingga konfigurasi model, didefinisikan sebagai data terstruktur. Proses pembentukan instruksi dilakukan secara otomatis berdasarkan templat yang sama sehingga masukan yang diterima model konsisten pada seluruh kombinasi eksperimen.

Sistem terorkestrasi ini dibangun atas tiga prinsip metodologis:

\begin{enumerate}
    \item \textbf{Determinisme masukan}.  
    Instruksi persona tidak disusun secara manual, tetapi dikonstruksi melalui templat tetap yang menggabungkan narasi persona dan stimulus pertanyaan. Dengan demikian, seluruh model menerima masukan yang identik pada tingkat karakter.

    \item \textbf{Pencatatan telemetri multi-dimensi}.  
    Keluaran model disimpan dalam berkas log yang memuat respons akhir, latensi, jumlah token, dan metadata eksekusi lainnya. Untuk model yang menyediakan \textit{reasoning trace}, elemen tersebut dicatat secara terpisah.

    \item \textbf{Skalabilitas eksekusi}.  
    Pipeline mendukung eksekusi paralel dengan pengelolaan batas layanan sehingga seluruh kombinasi model–persona–soal dapat diproses dalam satu sesi tanpa interaksi manual.
\end{enumerate}

Desain terorkestrasi ini memungkinkan penelitian berjalan secara sistematis dan menghasilkan data yang dapat diaudit. Selain itu, pendekatan ini selaras dengan rekomendasi metodologis untuk eksperimen berskala besar pada sistem dialog modern \parencite{tseng2024twotales,weidinger2021ethical}.

\subsection{Analisis Komparatif Metodologis}
\label{subsec:method-comparison}

Tabel~\ref{tab:komparasi-metodologis} membandingkan pendekatan konvensional dan pendekatan terorkestrasi berdasarkan lima dimensi metodologis: kendali masukan, granularitas data, format penyimpanan, keterulangan, dan skalabilitas. Tabel ini bertujuan memberikan gambaran komprehensif mengenai peningkatan kualitas evaluasi yang dicapai melalui sistem yang diusulkan.

\begin{table}[htbp]
\centering
\caption{Perbandingan Metodologis antara Pendekatan Konvensional dan Sistem Terorkestrasi}
\label{tab:komparasi-metodologis}
\renewcommand{\arraystretch}{1.28}
\small

\begin{tabularx}{\textwidth}{
  >{\raggedright\arraybackslash}p{3.3cm}
  X
  X
}
\toprule
\textbf{Dimensi Analisis} &
\textbf{Pendekatan Konvensional} &
\textbf{Pendekatan Terorkestrasi} \\
\midrule

\textit{Input Control} &
Formulasi instruksi dilakukan secara manual sehingga rawan variasi redaksional dan sulit direplikasi. &
Instruksi dibentuk secara programatis menggunakan templat tetap sehingga seluruh masukan konsisten. \\

\textit{Data Granularity} &
Rekaman data umumnya hanya mencakup jawaban akhir tanpa latensi, jumlah token, atau struktur internal proses. &
Log mencatat respons, latensi, token, dan \textit{reasoning trace} (jika tersedia) secara eksplisit. \\

\textit{Storage Format} &
Penyimpanan berbasis catatan manual atau lembar kerja sehingga kurang sesuai untuk analisis berskala besar. &
Seluruh artefak dicatat dalam format JSON dan CSV yang mudah diproses ulang. \\

\textit{Reproducibility} &
Tidak semua kondisi eksperimen terdokumentasi sehingga sulit dijalankan ulang oleh peneliti lain. &
Seluruh konfigurasi, templat persona, dan data benchmark didefinisikan secara eksplisit sehingga dapat direplikasi. \\

\textit{Scalability} &
Eksekusi linear dan mengandalkan interaksi manusia sehingga tidak efisien untuk jumlah kombinasi yang besar. &
Mendukung eksekusi paralel dan \textit{queueing} terkontrol untuk pengujian skala besar. \\
\bottomrule
\end{tabularx}
\end{table}

Secara keseluruhan, pendekatan terorkestrasi memberikan peningkatan yang signifikan dalam hal validitas internal, konsistensi eksekusi, dan kelengkapan data yang dihasilkan. Desain konseptual ini menjadi fondasi bagi implementasi pipeline yang dijelaskan pada bagian selanjutnya.

%====== BAB IV.2 ======
\section{Perancangan Arsitektur Perangkat Lunak (\textit{Evaluation Pipeline})}
\label{sec:perancangan-pipeline}

Subbab ini menjelaskan desain arsitektur perangkat lunak yang digunakan untuk merealisasikan \textit{evaluation pipeline} sebagaimana dirumuskan pada Subbab~\ref{sec:desain-konseptual}. Arsitektur pipeline dirancang agar proses evaluasi dapat berjalan secara otomatis, konsisten, dan dapat direproduksi. Pendekatan ini memastikan bahwa setiap kombinasi persona, model, dan \textit{benchmark task} diuji dalam kondisi yang setara dan bebas dari variasi yang tidak diperlukan.

Pipeline yang dibangun bekerja sebagai rangkaian komponen yang saling berinteraksi: mulai dari pemuatan data, konstruksi instruksi, pengiriman permintaan ke model, hingga pencatatan \textit{telemetry}. Seluruh proses tersebut bekerja dalam satu alur terintegrasi sehingga sistem mampu menangani jumlah evaluasi yang besar secara stabil.

\subsection{Arsitektur Alur Kerja Sistem}
\label{subsec:arsitektur-alur-kerja}

Secara garis besar, \textit{evaluation pipeline} terbagi ke dalam empat komponen utama yang membentuk satu siklus pemrosesan yang berulang untuk setiap kombinasi persona dan butir soal. Keempat komponen tersebut adalah sebagai berikut.

\begin{enumerate}
    \item \textit{Configuration initialization and validation}.\\
    Tahap ini memuat seluruh konfigurasi sistem, definisi persona, dan \textit{benchmark dataset} ke dalam memori. Validasi struktur data dilakukan untuk memastikan bahwa setiap persona memiliki \textit{system instruction} yang lengkap dan setiap butir tugas memiliki pasangan pertanyaan dan jawaban acuan. Validasi awal ini penting untuk mencegah kesalahan format yang dapat menghentikan proses pada tahap berikutnya.

    \item \textit{Prompt construction engine}.\\
    Pada tahap ini, sistem membentuk dua jenis pesan: \textit{system message} yang berisi identitas persona dan \textit{user message} yang memuat pertanyaan dari benchmark. Penyusunan instruksi dilakukan menggunakan pola yang seragam untuk seluruh iterasi, sehingga setiap model menerima bentuk stimulus yang konsisten. Pendekatan ini menghilangkan variasi yang berasal dari perbedaan penulisan instruksi manual.

    \item \textit{Execution manager}.\\
    Komponen ini mengatur pengiriman permintaan ke model-model bahasa melalui \textit{API interface}. Untuk mengatasi volume permintaan yang besar, \textit{execution manager} menggunakan pendekatan eksekusi asinkron dengan \textit{I/O concurrency}. Permintaan diatur dalam \textit{task queue} dan dieksekusi dalam kelompok sesuai batas \textit{rate limit}. Strategi ini mempercepat proses pengujian tanpa melampaui kapasitas layanan penyedia model.

    \item \textit{Telemetry logger}.\\
    Komponen terakhir bertanggung jawab menyimpan seluruh respons model dalam format terstruktur, termasuk \textit{model output}, jumlah token, serta \textit{latency}. Data ini digunakan sebagai dasar analisis performa pada bab berikutnya.
\end{enumerate}

Dengan pembagian tersebut, pipeline dapat beroperasi secara modular namun tetap terpadu dalam satu alur pemrosesan.

\subsection{Algoritma Orkestrasi dan Konkurensi}
\label{subsec:algoritma-orkestrasi}

Jumlah kombinasi persona, model, dan \textit{benchmark tasks} menghasilkan volume permintaan yang sangat besar. Oleh karena itu, pipeline menerapkan mekanisme eksekusi asinkron untuk meningkatkan efisiensi pemrosesan.

Pipeline pertama-tama membangun sebuah \textit{task queue} yang berisi seluruh pasangan persona–soal. Selanjutnya, \textit{task queue} diproses dalam kelompok yang ukurannya ditentukan oleh kapasitas \textit{concurrency}. Ketika satu kelompok tugas sedang diproses, sistem dapat menyiapkan kelompok berikutnya. Dengan demikian, waktu pemrosesan total dapat ditekan mendekati $O(N/C)$, di mana $N$ adalah jumlah permintaan dan $C$ adalah kapasitas konkurensi.

Apabila terjadi kegagalan seperti \textit{timeout}, \textit{connection reset}, atau batas \textit{rate limit}, pipeline tidak langsung menghentikan seluruh proses. Sebaliknya, tugas tersebut dicatat dan dieksekusi ulang dengan \textit{exponential backoff}. Pendekatan ini membuat pipeline tetap stabil meskipun dijalankan dalam waktu yang panjang.

\subsection{Mekanisme Injeksi Konteks Persona}
\label{subsec:mekanisme-injeksi}

Mekanisme injeksi persona merupakan elemen penting untuk memastikan bahwa pengaruh persona dapat diukur dengan jelas. Pipeline menerapkan dua tahap injeksi konteks yang bersifat tetap dan hanya dilakukan satu kali untuk setiap persona sebelum evaluasi dimulai.

Tahap pertama adalah \textit{persona context initialization}. Pada tahap ini, sistem menyusun pesan awal yang merangkum identitas dan karakter persona. Pesan ini berfungsi membangun \textit{cognitive framing} awal pada model, baik untuk persona eksplisit maupun implisit. Tahap ini memastikan bahwa model berada dalam kondisi persona yang konsisten sebelum diberikan tugas.

Tahap kedua adalah \textit{persona warm-up message}. Pesan ini digunakan untuk memastikan bahwa model memberikan respons yang sesuai dengan identitas persona. Respons dari tahap ini tidak digunakan dalam evaluasi, tetapi berfungsi sebagai verifikasi bahwa proses injeksi berhasil.

Setelah kedua tahap ini selesai, pipeline tidak lagi mengulangi injeksi persona untuk setiap pertanyaan. Identitas yang telah ditanamkan pada awal percakapan tetap digunakan selama seluruh rangkaian pengujian. Model kemudian langsung memproses seluruh soal pada GSM8K dan MMLU-Redux dalam kondisi persona yang sama. Pendekatan ini memastikan bahwa variasi keluaran model berasal dari perbedaan persona, bukan dari perbedaan struktur instruksi.

\subsection{Mekanisme Toleransi Kesalahan dan Persistensi Status}
\label{subsec:toleransi-kesalahan}

Pipeline dirancang agar tetap stabil meskipun menghadapi gangguan selama proses pengujian. Dua mekanisme utama digunakan untuk menjamin integritas data dan keberlanjutan proses.

Pertama, sistem menerapkan \textit{state persistence}. Setelah setiap tugas berhasil diproses, status kemajuan dicatat sehingga apabila terjadi interupsi, pipeline dapat dilanjutkan kembali tanpa mengulangi tugas yang sudah selesai.

Kedua, gangguan sementara ditangani dengan \textit{error handling} berbasis penjadwalan ulang adaptif. Tugas yang gagal tidak langsung dihentikan, tetapi dijalankan kembali setelah jeda waktu tertentu. Dengan kombinasi kedua strategi ini, pipeline dapat menyelesaikan seluruh rangkaian evaluasi meskipun terjadi kendala jaringan atau batasan layanan eksternal.
%====== BAB IV.3 ======
\section{Implementasi Data, Struktur Berkas, dan Keluaran Pipeline}
\label{sec:implementasi-data}

Subbab ini menjelaskan bagaimana rancangan pipeline yang telah disusun pada bagian sebelumnya direalisasikan dalam bentuk organisasi data, struktur direktori, serta format keluaran yang dihasilkan selama proses eksperimen. Implementasi ini dirancang untuk memastikan bahwa seluruh tahapan pemuatan aset, injeksi konteks persona, pelaksanaan inferensi, dan perekaman hasil berlangsung secara konsisten, terdokumentasi dengan baik, serta mendukung keterulangan eksperimen secara penuh.

\subsection{Organisasi Direktori dan Artefak Data}

Pipeline dijalankan di atas struktur direktori yang dirancang secara modular untuk memisahkan fungsi pemrosesan dan memudahkan proses audit ilmiah. Empat kelompok artefak utama disusun secara hierarkis sebagai berikut.

\begin{enumerate}
    \item \textit{Root directory}.  
    Berfungsi sebagai titik masuk eksekusi sistem dan memuat skrip penggerak pipeline beserta utilitas operasional.

    \item \textit{Configuration directory}.  
    Menyimpan konfigurasi teknis yang digunakan pipeline, termasuk daftar model, kredensial layanan API, dan parameter eksekusi. Pemisahan direktori ini mendukung aspek keamanan dan memudahkan penggantian parameter tanpa memodifikasi kode utama.

    \item \textit{Input assets directory}.  
    Memuat definisi persona serta himpunan benchmark yang telah dinormalisasi. Persona direpresentasikan dalam format terstruktur yang memuat identitas, atribut demografis, dan karakteristik gaya bahasa. Sementara itu, dataset GSM8K dan MMLU Redux dikonversi ke format konsisten untuk memastikan kompatibilitas dengan pipeline.

    \item \textit{Results directory}.  
    Menyimpan keseluruhan keluaran eksperimen yang mencakup log granular pada tingkat per butir soal, tabel hasil, serta agregasi lintas persona dan lintas model. Struktur ini memudahkan proses penelusuran kembali bagi keperluan analisis.
\end{enumerate}

Pemilahan direktori ini memastikan bahwa seluruh artefak eksperimen terdokumentasi secara terstruktur dan mudah direplikasi.

\subsection{Subsistem Perangkat Lunak dan Alur Transformasi Data}

Pipeline terdiri atas empat subsistem utama yang bekerja secara berurutan dalam mengelola eksekusi eksperimen:

\begin{enumerate}
    \item \textit{Execution orchestration subsystem}.  
    Subsistem ini membentuk \textit{task queue} yang memuat seluruh kombinasi model, persona, dan pertanyaan. Orkestrasi ini memastikan determinisme dan menghindari variasi eksekusi akibat intervensi manual.

    \item \textit{Model communication subsystem}.  
    Bertugas melakukan konstruksi instruksi, mengirimkan permintaan ke layanan model, menangani kode galat, serta menegakkan batas layanan seperti \textit{rate limit}. Seluruh komunikasi dilakukan menggunakan protokol API yang distandardisasi.

    \item \textit{Monitoring subsystem}.  
    Menyediakan mekanisme \textit{checkpointing} sehingga eksekusi dapat dilanjutkan tanpa kehilangan progres apabila terjadi gangguan jaringan atau penghentian proses secara tidak terduga. Hal ini memastikan konsistensi eksekusi dan mengurangi risiko duplikasi.

    \item \textit{Analysis subsystem}.  
    Mengolah log mentah menjadi tabel terstruktur dan menghitung metrik utama seperti akurasi, penggunaan token, dan latensi. Modul ini menghasilkan keluaran agregasi yang digunakan dalam tahap analisis pada Bab~V.
\end{enumerate}

Alur transformasi data berlangsung dari log granular menuju tabel pemetaan kemudian agregasi lintas model, sehingga memungkinkan analisis kuantitatif yang komprehensif.

\subsection{Representasi Persona dan Mekanisme Injeksi Konteks}

Persona direpresentasikan dalam format terstruktur yang memuat identitas demografis, atribut gaya bahasa, serta narasi yang relevan. Representasi tersebut kemudian dikonversi menjadi \textit{system instruction} yang ditempatkan pada segmen instruksi sistem saat permintaan dikirimkan ke model.

Injeksi konteks persona dilakukan satu kali melalui dua tahap:

\begin{enumerate}
    \item \textit{Persona grounding}.  
    Tahap ini menanamkan identitas dan karakteristik gaya bahasa persona secara eksplisit atau implisit pada konteks model.

    \item \textit{Warm up interaction}.  
    Dilakukan satu interaksi pemanasan untuk menstabilkan perilaku model sehingga respons pada tahap berikutnya mengikuti karakter persona secara konsisten.
\end{enumerate}

Setelah kedua tahap tersebut selesai, pipeline mengirim seluruh pertanyaan GSM8K dan MMLU Redux tanpa mengulang injeksi persona. Dengan demikian, kondisi kognitif model dijaga agar tetap setara di seluruh siklus inferensi.

\subsection{Contoh Struktur Log Inferensi}

Untuk menjaga transparansi dan keterulangan eksperimen, pipeline mencatat setiap interaksi dengan model dalam bentuk log terstruktur. Log ini memuat informasi mengenai konfigurasi eksekusi, isi jawaban model, serta telemetri penggunaan token. Cuplikan pada Kode~\ref{code:log-noreason} menunjukkan contoh keluaran untuk model yang tidak menyediakan \textit{reasoning trace}.

\begin{tcolorbox}[
    colback=gray!5,
    colframe=gray!50,
    title={Kode IV.1 Contoh log inferensi tanpa reasoning trace},
    fonttitle=\bfseries,
    arc=2mm,
    left=2mm,
    right=2mm,
    listing only
]
\footnotesize
\begin{verbatim}
{
 "run": {"model_id": "example-model", "question_id": "gsm8k_00001"},
 "response": {
   "choices": [{
     "message": {"content": "Let's break down the problem..."}
   }],
   "usage": {"prompt_tokens": 211, "completion_tokens": 197}
 }
}
\end{verbatim}
\end{tcolorbox}
\label{code:log-noreason}

Pada model tertentu, layanan juga menyediakan informasi tambahan mengenai proses penalaran internal yang digunakan untuk menghasilkan jawaban akhir. Informasi ini direkam sebagai \textit{reasoning trace} dan disimpan terpisah dari konten jawaban. Kode~\ref{code:log-reason} memperlihatkan contoh log untuk model yang menyediakan \textit{reasoning trace} beserta jumlah token yang digunakan pada bagian tersebut.

\begin{tcolorbox}[
    colback=gray!5,
    colframe=gray!50,
    title={Kode IV.2 Contoh log inferensi dengan reasoning trace},
    fonttitle=\bfseries,
    arc=2mm,
    left=2mm,
    right=2mm,
    listing only
]
\footnotesize
\begin{verbatim}
{
 "run": {"model_id": "example-model-reason", "question_id": "gsm8k_00003"},
 "response": {
   "choices": [{
     "message": {
       "content": "Final answer: 70000",
       "reasoning": "First compute the purchase cost..."
     }
   }],
   "usage": {"completion_tokens": 867, "reasoning_tokens": 485}
 }
}
\end{verbatim}
\end{tcolorbox}
\label{code:log-reason}

Kedua contoh tersebut menggambarkan bagaimana pipeline menangkap tidak hanya jawaban akhir, tetapi juga struktur penalaran dan sumber daya komputasi yang digunakan oleh model. Informasi ini menjadi dasar analisis lebih lanjut mengenai perbedaan perilaku antar model dan antar persona.

\subsection{Ringkasan Hasil Eksperimen}

Ringkasan performa lintas model dan persona ditampilkan pada Tabel~\ref{tab:gsm8k-summary-compact}. Tabel ini memberikan gambaran umum mengenai tingkat akurasi dan beban komputasi untuk setiap konfigurasi, dan digunakan sebagai dasar analisis pada Bab~V.

\begin{table}[htbp]
\centering
\caption{Ringkasan Hasil Eksperimen GSM8K untuk Seluruh Model dan Persona}
\label{tab:gsm8k-summary-compact}
\renewcommand{\arraystretch}{1.18}
\small

\begin{adjustbox}{max width=\textwidth}
\begin{tabular}{l l c c c c}
\toprule
\textbf{Model} &
\textbf{Persona} &
\textbf{Total Q} &
\textbf{Correct} &
\textbf{Accuracy (\%)} &
\textbf{Total Tokens} \\
\midrule

Bert Nebulon Alpha & man\_implicits   & 610  & 593  & 97.21 & 285250 \\
Bert Nebulon Alpha & woman\_implicits & 641  & 627  & 97.26 & 335208 \\
\midrule

Grok 4.1 Fast & man\_implicits   & 1315 & 1242 & 94.45 & 1325229 \\
Grok 4.1 Fast & woman\_implicits & 1316 & 1254 & 95.36 & 1422736 \\
\midrule

Nvidia Nemotron 12B v2 VL & man\_implicits   & 1305 & 1224 & 93.79 & 1156049 \\
Nvidia Nemotron 12B v2 VL & woman\_implicits & 1315 & 1248 & 94.98 & 1986284 \\
\bottomrule
\end{tabular}
\end{adjustbox}

\end{table}

Tabel tersebut menjadi dasar perbandingan antar model pada bab evaluasi, termasuk pengaruh persona terhadap akurasi dan kompleksitas respons.
